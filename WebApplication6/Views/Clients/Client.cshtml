
@model WebApplication6.Models.hc_client_user
@using System.Web.Optimization
@using Kendo.Mvc.UI
@using Kendo.Mvc.Extensions


@{
    ViewBag.Title = "Client";
    if (Session["userid"] == null)
    {
        Response.Redirect("/account/login");
    }


}

<meta charset="utf-8" />

<link rel="icon" type="image/png" href="assets/img/favicon.ico">

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<title>Light Bootstrap Dashboard by Creative Tim</title>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<meta name="viewport" content="width=device-width" />


<style>

    .collalogo {
        text-align: center;
        display: block;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        padding: 5px 0px;
        display: block;
        font-size: 32px;
        color: white;
        text-align: center;
        font-weight: 300;
        line-height: 30px;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

    .session {
        color: black;
        margin-left: 46px;
    }

    .button {
        color: #ffffff;
        background-color: #428bca;
        border-color: #357ebd;
    }

    .b1 {
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-size: 14px;
        font-weight: normal;
        line-height: 1.428571429;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        cursor: pointer;
        border: 1px solid transparent;
        border-radius: 4px;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        -o-user-select: none;
        user-select: none;
    }

    .ch1 {
        position: relative;
        display: block;
        overflow: hidden;
        padding: 4px 0 0 9px;
        height: 35px;
        width: 60%;
        border: 1px solid #aaa;
        border-radius: 5px;
        background-color: #fff;
        background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(20%, #ffffff), color-stop(50%, #f6f6f6), color-stop(52%, #eeeeee), color-stop(100%, #f4f4f4));
        background: -webkit-linear-gradient(top, #ffffff 20%, #f6f6f6 50%, #eeeeee 52%, #f4f4f4 100%);
        background: -moz-linear-gradient(top, #ffffff 20%, #f6f6f6 50%, #eeeeee 52%, #f4f4f4 100%);
        background: -o-linear-gradient(top, #ffffff 20%, #f6f6f6 50%, #eeeeee 52%, #f4f4f4 100%);
        background: linear-gradient(top, #ffffff 20%, #f6f6f6 50%, #eeeeee 52%, #f4f4f4 100%);
        background-clip: padding-box;
        box-shadow: 0 0 3px white inset, 0 1px 1px rgba(0, 0, 0, 0.1);
        color: #444;
        text-decoration: none;
        white-space: nowrap;
        line-height: 24px;
    }

    .pop1 {
        width: 50%;
        margin: 30px auto;
    }
   
</style>
<link href="~/summernote-bs4.css" rel="stylesheet" />
<link href="../assets/css/bootstrap.min.css" rel="stylesheet" />
<link href="../assets/css/animate.min.css" rel="stylesheet" />
<link href="../assets/css/light-bootstrap-dashboard.css" rel="stylesheet" />
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
<link href="../assets/css/pe-icon-7-stroke.css" rel="stylesheet" />
<link href="~/Content/chosen.css" rel="stylesheet" />





<script type="text/javascript">

</script>

@using (Html.BeginForm(FormMethod.Post))
{
    @Html.AntiForgeryToken()

    <!--CLIENT VIEW-->
    <div class="wrapper ">
        <div class="sidebar" data-color="blue" data-image="assets/img/sidebar-5.jpg">
            <!--

                Tip 1: you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple"
                Tip 2: you can also add an image using data-image tag

            -->

            <div class="sidebar-wrapper">
                <div class="logo">
                    <a class="collalogo" href="/Dashboard/Dash">
                        Collabera
                    </a>

                    @*<img src="~/Content/themes/base/images/Collabera_Logo_(Updated).jpg" class="img-responsive" width="150" height="63" />*@
                </div>

                <div id="test-form" class="session">

                    @*<h4>@Session["username"].ToString()</h4>
                        <h4>@Session["Time"].ToString()</h4>*@
                    <h5>@Session["username"].ToString()</h5>
                    <h5 style="font-weight:600;">Login Time:</h5><h5>@Session["Time"].ToString()</h5>

                </div>

                <ul class="nav">

                    <li>
                        <a href="/dashboard/Dash">
                            <i class="pe-7s-graph"></i>
                            <p style="margin: 0; line-height: 30px;font-size: 16px;font-weight: 400;margin-left: 45px;text-transform:capitalize;">Dashboard</p>
                        </a>
                    </li>
                    <li class="active">
                        <a href="/Clients/Client">
                            <i class="pe-7s-user"></i>
                            <p style="margin: 0; line-height: 30px;font-size: 16px;font-weight: 400;margin-left: 45px;text-transform:capitalize;">Client</p>
                        </a>
                    </li>
                    <li>
                        <a href="/Account/ResetPassword">
                            <i class="pe-7s-lock"></i>
                            <p style="margin: 0; line-height: 30px;font-size: 16px;font-weight: 400;margin-left: 45px;text-transform:capitalize;">Change Password</p>
                        </a>
                    </li>
                    <li>
                        <a href='/account/logout'>
                            <i class="pe-7s-close-circle"></i>
                            <p style="margin: 0; line-height: 30px;font-size: 16px;font-weight: 400;margin-left: 45px;text-transform:capitalize;">Log out</p>
                        </a>
                    </li>


                </ul>
            </div>
        </div>
        <div class="main-panel">
            <nav class="navbar navbar-default navbar-fixed">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <div class="navbar-brand" style="color:black;">
                            Timesheet Tracker
                        </div>
                    </div>

                </div>
            </nav>
            <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-12">

                            <div class="card" style="background-color:powderblue;">
                                <div class="content">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <br />
                                                <label class="card-label">Country</label>
                                                @Html.DropDownList("country", ViewBag.countries as List<SelectListItem>, null, new { @class = " input-validation-error ch1" })


                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <!--DROPDOWN FOR CLIENT NAME-->
                                                <br />
                                                <label class="card-label">Client Name</label>
                                                @Html.ListBox("client", (MultiSelectList)ViewBag.clients, new { @class = "input-validation-error   ch1", @multiple = "multiple" })

                                            </div>

                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <!--DROPDOWN FOR LOB-->
                                                <br />
                                                <label class="card-label">Line of Business</label>
                                                @Html.DropDownList("lob", ViewBag.lobs as List<SelectListItem>, new { @class = "input-validation-error ch1" })
                                            </div>


                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <!--dropdown for To date-->
                                                <label class="card-label">Year</label>
                                                <div class="">

                                                    @Html.DropDownListFor(model => model.year, ViewBag.years as List<SelectListItem>, ViewBag.year as string, new { @class = " input-validation-error ch1" })
                                                </div>



                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <!--dropdown for from date-->
                                                <label class="card-label">Month</label>
                                                <div class="">

                                                    @Html.ListBox("month", (MultiSelectList)ViewBag.months, new { @class = "input-validation-error  ch1" })

                                                    @Html.HiddenFor(a => a.valclient)
                                                    @Html.Hidden("m", ViewBag.m as string)
                                                </div>



                                            </div>
                                        </div>



                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <br />
                                                @ViewBag.msg

                                                <input type="submit" value="Load" id="Loadbtn" class="b1 button" formaction="Client">
                                            </div>
                                        </div>


                                    </div>


                                </div>


                            </div>



                        </div>
                    </div>
                    <div id="val"></div>


                    <div class="row">
                        <div class="col-sm-12 col-md-10 col-md-offset-1">
                            <div class="card ">
                                <div class="header">
                                    <h4 class="title text-center">Timesheet Statisitcs</h4>
                                    @*<p class="category">All products including Taxes</p>*@
                                </div>
                                <div class="content">
                                    <div id="container" style="height:300px;"></div>
                                    <div class="footer">

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>


                    <div id="valabout"></div>
                    <div class="col-md-12">
                        <div class="panel panel-primary list-panel" id="list-panel">
                            <div class="panel-heading list-panel-heading">
                                <h1 class="panel-title list-panel-title">Consultants</h1>
                            </div>
                            <div id="example">

                            </div>
                        </div>
                    </div>

                </div>
            </div>




        </div>
    </div>
}
<div class="modal" id='myModalt'>
    <div class="panel panel-primary modal-dialog col-sm-12 col-md-10 col-md-offset-1" style="width: 57%;margin: 4% -26%;overflow-y:scroll;">
        <div class="panel-heading" style="width:104%;margin-left:-2%;margin-top:-3%;">
            Mail
        </div>
        <div class="panel-body">
            <div id='myModalContenty' class="modal-body">
            </div>
        </div>
    </div>
</div>

<div class="modal" id="confirm" tabindex="-1" role="dialog" aria-labelledby="upload-avatar-title" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <label id="message"></label>

        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div class="col-sm-12 col-md-10 col-md-offset-1">
    <div class="modal" id='myModalts'>
        <div class="panel panel-primary modal-dialog col-sm-12 col-md-10 col-md-offset-1" style="width:50%;margin:4% -25%;overflow-y:scroll;">

            <div class="panel-heading" style="width:104%;margin-left:-2%;margin-top:-4%;">
                Mail History
            </div>
            <div class="panel-body">
                <div id='myModalConten'>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" style="background-color:#337ab7;color:white;">OK</button>
            </div>
        </div>
    </div>
</div>






<link href="~/Content/kendo/kendo.blueopal.min.css" rel="stylesheet" />
<!--POPUP-->
<script src="~/Scripts/bootstrap.js"></script>
<script src="https://kendo.cdn.telerik.com/2018.2.620/js/kendo.all.min.js"></script>
<script src="http://kendo.cdn.telerik.com/2018.2.620/js/jszip.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script>

<script src="~/scripts/chart/exporting.js"></script>
<script src="~/scripts/chart/highcharts.js"></script>
<script src="~/Scripts/chosen.jquery.js"></script>
<script id="fileTemplate" type="text/x-kendo-template">
    <span class='k-progress'></span>
    <div class='file-wrapper'>
        <span class='file-icon #=addExtensionClass(files[0].extension)#'></span>
        <h4 class='file-heading file-name-heading'>Name: #=name#</h4>
        <h4 class='file-heading file-size-heading'>Size: #=size# bytes</h4>
        <strong class="k-upload-status">
            <button type='button' class='k-upload-action'></button>
            <button type='button' class='k-upload-action'></button>
        </strong>
    </div>
</script>


<script type="text/x-kendo-template" id="template">
    <input type="button" id="category" class="k-button k-primary" value="Bulk Email" onclick="bulkemail()" />
</script>

<script>
    var selectedData = [];
    var selectedfrom = [];
    var selectedtill = [];

    function addExtensionClass(extension) {
        switch (extension) {
            case '.jpg':
            case '.img':
            case '.png':
            case '.gif':
                return "img-file";
            case '.doc':
            case '.docx':
                return "doc-file";
            case '.xls':
            case '.xlsx':
                return "xls-file";
            case '.pdf':
                return "pdf-file";
            case '.zip':
            case '.rar':
                return "zip-file";
            default:
                return "default-file";
        }
    }

    function monthvalidate(month) {
  
        var i;
        var flag = 0;
        var flag1 = 0;
      
        for (i = 0; i < month.length; i++) {
           
            if (month[i] == 0) {
                flag = 1;
                document.getElementById('Loadbtn').disabled = 'disabled';
            };
            if (month[i] != 0) {
                if (flag == 1) {
                    alert("Please select only ALL");
                    document.getElementById('Loadbtn').disabled = 'disabled';
                    flag1 = 1;
                    break;
                }
                else {
                    continue
                }

            }

        }
        if (flag == 1) {
            if (flag1 == 0) {

                document.getElementById('Loadbtn').disabled = '';
            }
        }

    }

    $(document).ready(function () {
        $(' #Loadbtn').click(function () {
           
            var x = $("#month").val();
            monthvalidate(x);

                
            if (x == null) {
                alert("Please enter Month");
                document.getElementById('Loadbtn').disabled = 'disabled';
            }

            if (document.getElementById("client").value == "") {
                alert("Please enter Client");
                document.getElementById('Loadbtn').disabled = 'disabled';
            }


        });
        $("#month").change(function () {
            document.getElementById('Loadbtn').disabled = '';
        });
        $("#client").chosen(
                   );
        $("#month").chosen();
        $("#country").chosen();
        $("#year").chosen();
        $("#lob").chosen();
        $("#year").change(function () {

            $("#month").empty();

            $.ajax({
                type: 'GET',
                url: '@Url.Action("GetMonths","Clients")',
                dataType: 'json',
                data: { iSelectedYear: $("#year").val() },
                success: function (city) {
                    var a = [];
                    $.each(city, function (i, city) {
                        a[i] = city.Value;
                        $("#month").append('<option value="'
                            + city.Value + '">'
                            + city.Text + '</option>');

                    });
                    $("#month").val(a[0]).trigger("chosen:updated");
                },
                error: function (ex) {
                    alert('Failed.' + ex);
                }
            });
        });
        var values = new Array();
        var record = 0;
        @foreach (var item in ViewBag.VALUE)
        {
         @:values.push({ EmployeeNo: "@item.EmployeeNo", ConsultantName: "@item.ConsultantName", PreEmail: "@item.PreEmail", MPhone: "@item.MPhone", DOJ: "@item.DOJ", ClientName: "@item.ClientName", TSstatus: "@item.TSstatus", TimeSheetFrom: "@item.TimeSheetFrom", TimeSheetTill: "@item.TimeSheetTill", TimesheetMonYear: "@item.TimesheetMonYear", CalType: "@item.CalType", LastEmailSentOn: "@item.LastEmailSentOn ", LastEmailSendTemplate: "@item.LastEmailSendTemplate ", LWD: "@item.LWD", EmpStat: "@item.EmpStatus", EmpType: "@item.EmpType", comment: "@item.comment" ,Rid:"@item.Rid"});

        }
        $("#example").kendoGrid({
            toolbar: [{ name: "excel", text: "Export To Excel", className: "k-button k-primary" }, { template: kendo.template($("#template").html()) }],
            excel: {
                fileName: "Pending timehseet.xlsx",
                proxyURL: "https://demos.telerik.com/kendo-ui/service/export",
                filterable: true,
                allPages: true
            },
            columns: [{ selectable: "multiple, row", width: "90px", color: "skyblue" },
                 {
                     title: "Action", template: "<span class='glyphicon glyphicon-envelope approveCSS' aria-hidden='true' data-toggle='tooltip' title='Mail' onclick=\"openPopUp('#=EmployeeNo#','#=ConsultantName#','#=TimeSheetFrom#','#=TimeSheetTill#','#=PreEmail#')\"></span>",
                     filterable: false,
                     sortable: false, width: "90px"
                },
             { title: "Emp No", field: "EmployeeNo", template: " <span class='tooltiptext' aria-hidden='true' data-toggle='tooltip' title='History'onclick=\"openemploye('#=EmployeeNo#','#=TimeSheetFrom#','#=TimeSheetTill#')\">#=EmployeeNo# </span>", width: "130px" },
            { title: "Name", field: "ConsultantName", width: "170px" },
            { title: "Email ID", field: "PreEmail", template: " <a href='mailto:#= PreEmail #' >#=PreEmail#</a>", width: "170px" },
                { title: "Mobile", field: "MPhone", width: "150px" },
                { title: "Emp Status", field: "EmpStat", width: "150px" },
                { title: "Emp Type", field: "EmpType", width: "150px"},
                { title: "DOJ", field: "DOJ", width: "150px" },
                { title: "LWD", field: "LWD", width: "150px" },
              { title: "Client", field: "ClientName", width: "150px" },
              { title: "TS Status", field: "TSstatus", width: "150px" },
              { title: "TS From", field: "TimeSheetFrom", width: "150px" },
              { title: "TS Till", field: "TimeSheetTill", width: "150px" },
              { title: "TS Month Year", field: "TimesheetMonYear", width: "150px" },
                { title: "Calculation Type", field: "CalType", width: "150px" },
                {
                    title: "Comment", template: "<div class='w3-tooltip'><input type='text' id='comments#=Rid#' name='FirstName' value='#=comment#' class='k-textbox' data-toggle='tooltip' data-placement='top' title='#=comment#'> <input class='k-button' type='button' value='Save' onclick=\"savethedata('#=EmployeeNo#','#=TimeSheetFrom#','#=TimeSheetTill#',document.getElementById('comments#=Rid#').value)\"></div> ", width: "300px" },
                { title: "Last Email Sent ", field: "LastEmailSentOn ", width: "150px" },
                { title: "Last Email template Id", field: "LastEmailSendTemplate", width: "150px" },
            ],
            dataSource: {
                data: values,
                pageSize: 30,
            },
            height: 700,
            scrollable: {
                virtual: true
            },
            pageable: {
                refresh: true,
                pageSizes: true
               
            },
            sortable: {
                mode: "multiple"
            },
            filterable: true,
            groupable: true,
            reorderable: true,
            resizable: true,
            navigatable: true,
            change: function (e) {
                var selectedRows = this.select();
                var selectedDataItems = [];
                var selectstartdate = [];
                var selectenddate = [];
               
                for (var i = 0; i < selectedRows.length; i++) {
                    var dataItem = this.dataItem(selectedRows[i]);
                    selectstartdate.push(dataItem.TimeSheetFrom);
                    selectenddate.push(dataItem.TimeSheetTill);
                    selectedDataItems.push(dataItem.EmployeeNo);
                }
                selectedData = selectedDataItems;
                selectedfrom = selectstartdate;
                selectedtill = selectenddate;
;

            }
        });
        if ('@ViewBag.Status' != '') {
            alert('@ViewBag.Status');
        }
        $(function () {
            var clientdetails = $("#client").val();
            var monthdetails = $("#month").val()
            $.ajax({
                type: 'POST',
                url: '@Url.Action("Getdata")',
                dataType: 'json',
                data: { cid: clientdetails, coid: $("#country").val(), year: $("#year").val(), month: monthdetails, lob: $("#lob").val() },
                success: function (data) {
                    Highcharts.chart('container', {
                        chart: {
                            plotBackgroundColor: null,
                            plotBorderWidth: null,
                            plotShadow: false,
                            type: 'pie',
                            backgroundColor: ""
                        },
                        title: {
                            text: ''
                        },
                        credits: {
                            enabled: false
                        },
                        tooltip: {
                            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                        },
                        plotOptions: {
                            pie: {
                                size: 250,
                                allowPointSelect: true,
                                cursor: 'pointer',
                                shadow: 0.02,
                                dataLabels: {
                                    enabled: true,
                                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                    style: {
                                        fontFamily: 'Trebuchet MS,Verdana,sans-serif',
                                        fontshadow: '0px 0px #ff0000',

                                        fontSize: '15px',
                                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor)
                                    }
                                },
                                showInLegend: true
                            }
                        },
                        legend: {
                            itemStyle: {
                                font: '16pt Trebuchet MS, Verdana, sans-serif',

                                color: '#000000'
                            },

                            layout: 'proximate',
                            align: 'right',
                            alignColumns: true,

                            verticalAlign: 'middle',
                            useHTML: true,
                            labelFormatter: function () {
                                return '<div >' + this.name + '    :   ' + this.y + '</div>';
                            }
                        },
                        series: [{
                            name: 'Timesheet',
                            colorByPoint: true,
                            data: [{
                                name: 'Submitted',

                                y: data.admin

                            }, {
                                name: 'Received',
                                y: data.Finance
                            }, {
                                name: ' Rejected',
                                y: data.sales
                            }, {
                                name: 'Approved',
                                y: data.delivery
                            },
                            {
                                name: 'Missing',
                                y: data.superuser
                            }]
                        }]
                    });
                }

            });
        });
        $("#country").change(function () {
            var client = $("#country").val();
            if ($("#client").val() != null) {
                $("#client").empty();
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("getclient")',
                    dataType: 'json',
                    data: { id: $("#country").val() },
                    success: function (city) {
                        var a = [];
                        $.each(city, function (i, city) {
                            a[i] = city.Value;
                            $("#client").append('<option value="'
                                                       + city.Value + '">'
                                + city.Text + '</option>');
                        });
                        $("#client").val(a[0]).trigger("chosen:updated");
                        var vals = $("#client").val();
                        $("#lob").empty();
                        $.ajax({
                            type: 'POST',
                            url: '@Url.Action("getlob")',
                            dataType: 'json',
                            data: { id: vals, country: $("#country").val() },
                            success: function (city) {
                                var b = [];
                                $.each(city, function (i, city) {
                                    b[i] = city.Value;
                           
                                    $("#lob").append('<option value="'
                                        + city.Value + '">'
                                        + city.Text + '</option>');

                                });
                                $("#lob").trigger("chosen:updated");
                            },

                        });
                    },

                });
            }
            else {

            }

        })

        $("#client").change(function () {
            document.getElementById('Loadbtn').disabled = '';

            var vals = $("#client").val();

            $("#lob").empty();
            if ($("#client").val() != null) {
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("getlob")',
                    dataType: 'json',
                    data: { id: vals, country: $("#country").val() },
                    success: function (city) {
                        var b = [];
                        $.each(city, function (i, city) {
                            b[i] = city.Value;
                            $("#lob").append('<option value="'
                                + city.Value + '">'
                                + city.Text + '</option>');

                        });
                        $("#lob").val(b[0]).trigger("chosen:updated");
                    },

                });

            }

        });

    });
    function savethedata(employeeid, from, till, comment) {
        //alert(employeeid + from + till + comment);

        $.ajax({
                type: "GET",
                url: '@Url.Action("updatecomment")',
                contentType: "application/json ",
            data: { empid: employeeid, from: from, till: till, comment: comment },
                datatype: "json",
            success: function (response) {
                alert(" Saved ");
                },
            });
    }
    function bulkemail() {
        var monthdata = $("#month").val().toString();
        var vals = $("#client").val().toString();
        var options = { "backdrop": "static", keyboard: true };
        if (selectedData[0] == undefined) {

            alert("please select any consultant");
        }
        else {
            var uniqallskill = _.uniq(selectedData); 
            var emailid = uniqallskill.toString();

            $.ajax({
                type: "GET",
                url: '@Url.Action("SendEmail")',
                contentType: "application/json ",
                data: { bulkemail: emailid ,cid: vals, countryid: $("#country").val(), lobid: $("#lob").val(), year: $("#year").val(), month: monthdata  },
                datatype: "json",
                success: function (response) {
                    $('#myModalContenty').html(response);

                    $('#myModalt').modal(options);
                    $('#myModalt').modal('show');
                    $('#myModalt').modal('handleUpdate');

                },
               
            });
        }
    }
    function substringdata(str) {
        var allskill = str.split(",");
        var res = "";
        for (i = 0; i <= 5; i++) {
            if (allskill[i] != undefined) {
                if (res.length > 0) {

                    res += ","; // Add a comma if data already exists
                }
                res += "" + allskill[i] + "";
            }
            else {
                break;
            }
        }
        if (allskill[6] != undefined) {
            res = res + " ...<b> more </b>";

        };
        var data = "<a  data-toggle='tooltip' style='color:black;' title='" + str + "'>" + res + "</a>"

        return data;
    }
    function openemploye(empno,from,till) {
        var options = { "backdrop": "static", keyboard: true };
        $.ajax({
            type: "GET",
            url: '@Url.Action("getemail")',
            contentType: "application/json ",
            data: { empno: empno, from: from, till: till },
            datatype: "json",
            success: function (data1) {

                $('#myModalConten').html(data1);
                $('#myModalts').modal(options);
                $('#myModalts').modal('show');
                $('#myModalts').modal('handleUpdate');

            },
        });
    }

    function openPopUp(empno, name, from, till,emailid1) {
        var emailid = selectedData.toString();
        var monthdata = $("#month").val().toString();
        var vals = $("#client").val().toString();
        var options = { "backdrop": "static", keyboard: true };
        $.ajax({
            type: "GET",
            url: '@Url.Action("SendEmail")',
            data: { cid: vals, clid: empno, name: name, from: from, till: till, countryid: $("#country").val(), lobid: $("#lob").val(), year: $("#year").val(), month: monthdata },
            datatype: "json",
            contentType: "application/json ",
            success: function (data1) {


                $('#myModalContenty').html(data1);
                $('#myModalt').modal(options);

                $('#myModalt').modal('show');
                $('#myModalt').modal('handleUpdate');

            },

        });

    };
    function emailinformation(emaildata) {

        $('.modal-body #ToEmail').val(emaildata);
    }
    //mail script
</script>
<style>
    span:hover {
        color: brown;
        display: inline-block;
    }

    .k-virtual-scrollable-wrap td {
        font-size: 18px;
        white-space: nowrap;
        line-height: 20px;
    }

    #example .k-grid-header .k-header {
        font-size: 18px;
        white-space: nowrap;
        line-height: 20px;
    }

    #example .k-virtual-scrollable-wrap tr td {
        height: 20px;
    }
</style>
